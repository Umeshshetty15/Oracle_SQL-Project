CREATE TABLE CUSTOMERS (
       CUSTOMER_ID NUMBER(10) PRIMARY KEY,
       CUSTOMER_NAME VARCHAR(100),
       CONTACT_NUMBER NUMBER(10),
       CITY  VARCHAR(50)
);


CREATE TABLE PRODUCTS (
       PRODUCT_ID NUMBER(10) PRIMARY KEY,
       PRODUCT_NAME VARCHAR(50),
       CATE_GORY   VARCHAR(50),
       PRICE DECIMAL(10, 2)
);



CREATE TABLE SALES (
       SALES_ID NUMBER(10) PRIMARY KEY,
       CUSTOMER_ID NUMBER(10),
       PRODUCT_ID NUMBER(10),
       SALE_DATE  DATE,
       QUANTITY NUMBER(10),
       TOTAL_AMOUNT DECIMAL (10,2),
       FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMERS(CUSTOMER_ID),
       FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTS(PRODUCT_ID)
);
       

COMMIT;



INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (1, 'RAHUL SHARMA', '9876543210', 'DELHI');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (2, 'PRIYA SINGH', '9123456789', 'MUMBAI');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (3, 'VIKRAM PATEL', '9867543210', 'AHMEDABAD');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (4, 'AARAV VERMA', '9123345567', 'BANGALORE');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (5, 'NEHA AGARWAL', '9845123456', 'CHENNAI');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (6, 'RAVI MEHTA', '9876543120', 'KOLKATA');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (7, 'ANITA KUMAR', '9786543210', 'HYDERABAD');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (8, 'VIVEK GUPTA', '9123456709', 'PUNE');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (9, 'SANJANA NAIR', '9234567891', 'KOCHI');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (10, 'MANISH DESAI', '9354678123', 'SURAT');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (11, 'KAVYA RAO', '9432167890', 'VISAKHAPATNAM');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (12, 'ROHAN SHARMA', '9534678124', 'JAIPUR');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (13, 'NISHA YADAV', '9634567890', 'LUCKNOW');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (14, 'KARAN JOSHI', '9743216789', 'CHANDIGARH');

INSERT INTO CUSTOMERS (CUSTOMER_ID, CUSTOMER_NAME, CONTACT_NUMBER, CITY)
VALUES (15, 'ANIL KUMAR', '9123456890', 'PATNA');


SELECT *
FROM CUSTOMERS;



INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (1, 'LAPTOP', 'ELECTRONICS', 40000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (2, 'MOBILE', 'ELECTRONICS', 15000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (3, 'TABLET', 'ELECTRONICS', 25000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (4, 'HEADPHONES', 'ELECTRONICS', 2000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (5, 'SPEAKERS', 'ELECTRONICS', 3500);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (6, 'TV', 'ELECTRONICS', 30000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (7, 'CAMERA', 'ELECTRONICS', 45000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (8, 'PRINTER', 'ELECTRONICS', 5000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (9, 'MONITOR', 'ELECTRONICS', 10000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (10, 'KEYBOARD', 'ELECTRONICS', 1500);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (11, 'MOUSE', 'ELECTRONICS', 1000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (12, 'SMARTWATCH', 'ELECTRONICS', 12000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (13, 'REFRIGERATOR', 'APPLIANCES', 30000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (14, 'WASHING MACHINE', 'APPLIANCES', 20000);

INSERT INTO PRODUCTS (PRODUCT_ID, PRODUCT_NAME, CATE_GORY, PRICE)
VALUES (15, 'MICROWAVE', 'APPLIANCES', 8000);

SELECT * FROM PRODUCTS;



INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (1, 1, 1, TO_DATE('2024-10-01', 'YYYY-MM-DD'), 2, 80000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (2, 2, 2, TO_DATE('2024-10-02', 'YYYY-MM-DD'), 1, 15000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (3, 3, 3, TO_DATE('2024-10-03', 'YYYY-MM-DD'), 3, 75000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (4, 4, 4, TO_DATE('2024-10-04', 'YYYY-MM-DD'), 1, 2000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (5, 5, 5, TO_DATE('2024-10-05', 'YYYY-MM-DD'), 5, 17500);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (6, 6, 6, TO_DATE('2024-10-06', 'YYYY-MM-DD'), 1, 30000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (7, 7, 7, TO_DATE('2024-10-07', 'YYYY-MM-DD'), 2, 90000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (8, 8, 8, TO_DATE('2024-10-08', 'YYYY-MM-DD'), 1, 5000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (9, 9, 9, TO_DATE('2024-10-09', 'YYYY-MM-DD'), 2, 20000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (10, 10, 10, TO_DATE('2024-10-10', 'YYYY-MM-DD'), 4, 6000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (11, 11, 11, TO_DATE('2024-10-11', 'YYYY-MM-DD'), 1, 12000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (12, 12, 12, TO_DATE('2024-10-12', 'YYYY-MM-DD'), 3, 36000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (13, 13, 13, TO_DATE('2024-10-13', 'YYYY-MM-DD'), 1, 30000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (14, 14, 14, TO_DATE('2024-10-14', 'YYYY-MM-DD'), 2, 40000);

INSERT INTO SALES (SALES_ID, CUSTOMER_ID, PRODUCT_ID, SALE_DATE, QUANTITY, TOTAL_AMOUNT)
VALUES (15, 15, 15, TO_DATE('2024-10-15', 'YYYY-MM-DD'), 1, 8000);

SELECT * FROM SALES;



---FINDING THE TOP SELLING PRODUCTS------

SELECT PRODUCT_NAME, SUM(QUANTITY) AS TOTAL_QUANTITY
FROM PRODUCTS P INNER JOIN SALES S
ON P.PRODUCT_ID = S.PRODUCT_ID
GROUP BY PRODUCT_NAME
ORDER BY TOTAL_QUANTITY DESC;


----FINDING TOTAL SALES PER CUSTOMER-----

SELECT C.CUSTOMER_NAME, SUM(S.TOTAL_AMOUNT) AS TOTAL_SPENT
FROM CUSTOMERS C JOIN SALES S
ON C.CUSTOMER_ID = S.CUSTOMER_ID
GROUP BY  C.CUSTOMER_NAME
ORDER BY TOTAL_SPENT DESC;


----FINDING MONTHLY SALES REPORT-----

SELECT TO_CHAR(SALE_DATE, 'MM-YYYY') AS SALE_MONTH, SUM(TOTAL_AMOUNT) AS TOTAL_SALES
FROM SALES
GROUP BY TO_CHAR(SALE_DATE, 'MM-YYYY')
ORDER BY SALE_MONTH;

----FINDING PRODUCT CATEGORY PERFORMANCE----

SELECT CATE_GORY, SUM(S.TOTAL_AMOUNT) AS TOTAL_SALES
FROM PRODUCTS P JOIN SALES S
ON P.PRODUCT_ID = S.PRODUCT_ID
GROUP BY CATE_GORY
ORDER BY TOTAL_SALES DESC;


-----FINDING CUSTOMER PURCHASE FREQUENCY-----

SELECT CUSTOMER_NAME, COUNT(SALES_ID) AS PURCHASE_COUNT
FROM CUSTOMERS C 
JOIN SALES S ON C.CUSTOMER_ID = S.CUSTOMER_ID
GROUP BY CUSTOMER_NAME
HAVING COUNT(SALES_ID) > 1
ORDER BY PURCHASE_COUNT DESC;

COMMIT;






 


















       